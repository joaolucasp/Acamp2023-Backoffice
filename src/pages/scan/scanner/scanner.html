<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <!-- Meta tags Obrigatórias -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--  -->
    <meta property="og:title" content="App Backoffice Acampamento 2023" />
    <meta property="og:description"
        content="App Backoffice Acampamento 2023 - Igreja do Evangelho Quadrangular Região 513" />

    <!-- Bootstrap CSS & JS-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>


    <!-- Imports Style CSS -->
    <link rel="stylesheet" href="../../stylesheet/default-content.css" type="text/css">
    <link rel="stylesheet" href="../../../components/bottom-menu/bottom-menu.css" type="text/css">
    <link rel="stylesheet" href="../../../components/header/header.css" type="text/css">
    <link rel="stylesheet" href="../../../utils/color.css" type="text/css">
    <link rel="stylesheet" href="../../../utils/typography.css" type="text/css">

    <!-- Imports Components CSS -->
    <link rel="stylesheet" href="../../../components/single-result-search/single-result-search.css">
    <link rel="stylesheet" href="../../../components/scanner-qrcode/scanner.css">
    <link rel="stylesheet" href="../../../components/main-image-page/main-image-page.css">
    <link rel="stylesheet" href="../../../components/buttons/buttons.css" type="text/css">
    <link rel="stylesheet" href="../../../components/modal/modal.css" type="text/css">
    <link rel="stylesheet" href="../../../components/field/field.css" type="text/css">

    <!-- Font Awesome Icons -->
    <script src="https://kit.fontawesome.com/eac825cd8d.js" crossorigin="anonymous"></script>

    <!-- Shortcut Icon -->
    <link rel="shortcut icon" href="../../../../public/logo.png" type="image/x-icon">

    <!-- Javascript File's -->
    <script src="../../../api/getUser.js"></script>
    <script src="../../../api/registerCheckin.js"></script>
    <script src="../../../utils/tools.js"></script>
    <script src="../../../components/spinner/spinner.js"></script>

    <title>APP Backoffice - Scanner</title>
</head>

<body>
    <header id="header">
        <img class="img-fluid" src="../../../../public/deeper-white.png" alt="">
    </header>

    <button type="button" class="btn back-button" id="backButton" onclick="backStep();">
        <i class="fa-solid fa-arrow-left"></i>
    </button>

    <section id="mainContainer" class="container">

        <div class="row">
            <section id="pageContent">
                <div id="spinner" class="d-flex justify-content-center text-primary d-none">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>

                <div id="scannerScreen" class="d-none">
                </div>

                <div id="codeRoute" class="d-none">
                    <h2 class="main-title">Insira a chave do acampante</h2>

                    <fieldset class="fieldset m-auto w-75">
                        <div class="form-floating">
                            <input required='' name="key" id="key" class="form-control field" inputmode="text"
                                minlength="4" placeholder="Identificador (ID)" autocomplete="off">
                            <label for="key">Identificador (ID)</label>
                        </div>
                    </fieldset>

                    <button type="button" class="btn button-primary"
                        onclick="onCodeSuccess(document.getElementById('key').value);">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        <span>Consultar Acampante</span>
                    </button>
                </div>

                <div id="tableView" class="d-none">
                    <h2 class="main-title">Dados do Acampante</h2>

                    <div class="table-responsive">
                        <table id="singleResultSearch" class="table table-striped">
                            <tbody>
                                <tr>
                                    <th scope="row">
                                        <span class="field-result-search">
                                            <i class="fa-solid fa-hashtag"></i>
                                            ID
                                        </span>
                                    </th>
                                    <td class="id-result-search"></td>
                                </tr>

                                <tr>
                                    <th scope="row">
                                        <span class="field-result-search">
                                            <i class="fa-solid fa-person"></i>
                                            Nome
                                        </span>
                                    </th>
                                    <td class="name-result-search"></td>
                                </tr>

                                <tr>
                                    <th scope="row">
                                        <span class="field-result-search">
                                            <i class="fa-regular fa-calendar"></i>
                                            Idade
                                        </span>
                                    </th>
                                    <td class="age-result-search"></td>
                                </tr>

                                <tr>
                                    <th scope="row">
                                        <span class="field-result-search">
                                            <i class="fa-solid fa-mobile"></i>
                                            Telefone
                                        </span>
                                    </th>
                                    <td class="telefone-result-search"></td>
                                </tr>

                                <tr>
                                    <th scope="row">
                                        <span class="field-result-search">
                                            <i class="fa-solid fa-cross"></i>
                                            Igreja
                                        </span>
                                    </th>
                                    <td class="church-result-search"></td>
                                </tr>

                                <tr>
                                    <th scope="row">
                                        <span class="field-result-search">
                                            <i class="fa-solid fa-envelope"></i>
                                            E-mail
                                        </span>
                                    </th>
                                    <td class="email-result-search"></td>
                                </tr>

                                <tr>
                                    <th scope="row">
                                        <span class="field-result-search">
                                            <i class="fa-solid fa-credit-card"></i>
                                            Pagamento
                                        </span>
                                    </th>
                                    <td class="payment-result-search payment"></td>
                                </tr>

                            </tbody>
                        </table>
                    </div>

                    <div class="buttons-container d-grid gap-2">
                        <button type="button" class="btn button-primary" data-bs-toggle="modal"
                            data-bs-target="#staticBackdrop">
                            <i class="fa-solid fa-check"></i>
                            <span>Confirmar Check-in</span>
                        </button>

                        <button type="button" class="btn button-secondary" onclick="window.location='../scan.html';">
                            <i class="fa-solid fa-times"></i>
                            <span>Cancelar</span>
                        </button>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false"
                        tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="staticBackdropLabel">
                                        Confirmar <strong>Check-in</strong> do acampante?
                                    </h1>
                                </div>
                                <div class="modal-footer">
                                    <div class="d-inline-block w-100">
                                        <button type="button" class="btn button-primary w-25" data-bs-dismiss="modal"
                                            onclick="confirmCheckin();">
                                            Sim
                                        </button>

                                        <button type="button" class="btn button-secondary w-25" data-bs-dismiss="modal">
                                            Não
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="scanningFail" class="d-none">
                    <div id="mainImagePage" class="container">
                        <img class="img-fluid" src="../../../assets/images/emoji-sad.png" alt="">
                    </div>

                    <p><strong>Acampante não encontrado!</strong> Verifique os dados e tente novamente.</p>

                    <button type="button" class="btn button-primary" onclick="window.location='../scan.html';">
                        <i class="fa-solid fa-arrow-left"></i>
                        <span>Voltar</span>
                    </button>
                </div>

                <div id="checkinSuccess" class="d-none">
                    <div id="mainImagePage" class="container">
                        <img class="img-fluid" src="../../../assets/images/success.png" alt="">
                    </div>

                    <p>Check-in realizado com sucesso!</p>

                    <button type="button" class="btn button-primary" onclick="window.location='../scan.html';">
                        <i class="fa-solid fa-arrow-left"></i>
                        <span>Voltar</span>
                    </button>
                </div>

                <div id="serverError" class="d-none">
                    <div id="mainImagePage" class="container">
                        <img class="img-fluid" src="../../../assets/images/server-error.png" alt="">
                    </div>

                    <p><strong>Erro no servidor!</strong> Contate o João Lucas.</p>

                    <button type="button" class="btn button-primary" onclick="window.location='../scan.html';">
                        <i class="fa-solid fa-arrow-left"></i>
                        <span>Voltar</span>
                    </button>
                </div>

            </section>
        </div>
    </section>

    <nav id="bottomMenu" class="navbar">
        <div class="section-buttons">
            <a class="actived item-menu navbar-brand" href="../scan.html">
                <i class="fa-sharp fa-solid fa-qrcode">
                    <span>Check-in</span>
                </i>
            </a>

            <a class="item-menu navbar-brand" href="../../camper/camper.html">
                <i class="fa-solid fa-circle-user">
                    <span>Dados</span>
                </i>
            </a>

            <a class="item-menu navbar-brand" href="../../church/church.html">
                <i class="fa-solid fa-church">
                    <span>Igreja</span>
                </i>
            </a>
        </div>
    </nav>

    <script src="../../../components/scanner-qrcode/html5-qrcode.min.js"></script>
    <script src="scanner.js"></script>
    <script src="routes-scanner.js"></script>

    <script>
        window.onload = function () {
            firstRoute();
        }
    </script>
</body>

</html>